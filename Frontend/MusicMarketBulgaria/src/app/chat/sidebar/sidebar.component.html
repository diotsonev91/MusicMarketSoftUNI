<aside class="sidebar">
  <h2>Съобщения</h2>

  <!-- Filter Buttons -->
  <div class="filter-buttons">
    <button 
      [class.active]="!showUnreadOnly" 
      (click)="toggleFilter(false)">
      Всички
    </button>
    <button 
      [class.active]="showUnreadOnly" 
      (click)="toggleFilter(true)">
      Непрочетени
    </button>
  </div>

  <div class="messages-section">
    @for (conversation of filteredConversations; track conversation.participant._id) {
      <div
        class="message-item"
        [class.active]="selectedConversationUser === conversation.participant._id"
        (click)="selectConversation(conversation)">
        <strong>{{ conversation.participant.username }}</strong>
        <p>{{ conversation.lastMessage?.content }}</p>
        @if (conversation.unreadCount && conversation.unreadCount > 0) {
          <span class="unread-count">
            {{ conversation.unreadCount }}
          </span>
        }
        <span>
          {{ conversation.lastMessage?.timestamp | customDate }}
        </span>
      </div>
    }
  </div>
</aside>
